/*! ng-d3 v0.0.0 | 2014-04-26 */
!function(a,b){"use strict";var c=angular.module("ngD3.directives",[]);angular.module("ngD3",["ngD3.directives"]),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e});var d=function(a,c,d){var e=this,f={chartType:null,data:[],color:[],margin:{},showXAxis:!0,xValue:null,xShowMaxMin:!0,xAxisLabel:null,xAxisTickFormat:null,x2AxisLabel:null,x2AxisTickFormat:null,showYAxis:!0,yValue:null,yShowMaxMin:!0,yAxisLabel:null,yAxisTickFormat:null,y1AxisLabel:null,y1AxisTickFormat:null,y2AxisLabel:null,y2AxisTickFormat:null,y3AxisLabel:null,y3AxisTickFormat:null,y4AxisLabel:null,y4AxisTickFormat:null,showLabels:!0,labelThreshold:.5,labelType:"key",donut:!1,donutRatio:0,staggerLabels:!1,tooltips:!0,showValues:!1,useInteractiveGuideline:!1,transitionDuration:null};e.data=[],e.config=b.extend(f,d),e.updateConfig=function(a){e.config=b.extend(e.config,a),"object"==typeof e.config.data&&(e.data=e.config.data)},e.setChartType=function(a){"string"==typeof a&&(e.model=nv.models[a])},e.configAxis=function(a){"function"==typeof e.config.xValue&&a.x(e.config.xValue),"function"==typeof e.config.yValue&&a.y(e.config.yValue),a.xAxis&&a.xAxis.showMaxMin&&a.xAxis.showMaxMin(!!e.config.xShowMaxMin),a.yAxis&&a.yAxis.showMaxMin&&a.yAxis.showMaxMin(!!e.config.yShowMaxMin),e.setAxisLabel(a,"xAxis",e.config.xAxisLabel),e.setAxisLabel(a,"x2Axis",e.config.x2AxisLabel),e.setAxisLabel(a,"yAxis",e.config.yAxisLabel),e.setAxisLabel(a,"y1Axis",e.config.yAxisLabel),e.setAxisLabel(a,"y2Axis",e.config.yAxisLabel),e.setAxisLabel(a,"y3Axis",e.config.yAxisLabel),e.setAxisLabel(a,"y4Axis",e.config.yAxisLabel),e.setTickFormat(a,"xAxis",e.config.xAxisTickFormat),e.setTickFormat(a,"x2Axis",e.config.x2AxisTickFormat),e.setTickFormat(a,"yAxis",e.config.yAxisTickFormat),e.setTickFormat(a,"y1Axis",e.config.y1AxisTickFormat),e.setTickFormat(a,"y2Axis",e.config.y2AxisTickFormat),e.setTickFormat(a,"y3Axis",e.config.y3AxisTickFormat),e.setTickFormat(a,"y4Axis",e.config.y4AxisTickFormat)},e.setAxisLabel=function(a,b,c){a[b]&&a[b].axisLabel&&"string"==typeof c&&a[b].axisLabel(c)},e.setTickFormat=function(a,b,c){a[b]&&a[b].tickFormat&&"string"==typeof c?a[b].tickFormat(d3.format(c)):a[b]&&a[b].tickFormat&&"function"==typeof c&&a[b].tickFormat(c)},e.render=function(){if(e.setChartType(e.config.chartType),e.model){var a=e.model();a.margin&&a.margin(e.config.margin),a.color&&e.config.color.length&&a.color(e.config.color),a.useInteractiveGuideline&&a.useInteractiveGuideline(!!e.config.useInteractiveGuideline),a.staggerLabels&&a.staggerLabels(!!e.config.staggerLabels),a.tooltips&&a.tooltips(!!e.config.tooltips),a.showValues&&a.showValues(!!e.config.showValues),a.showLabels&&a.showLabels(!!e.config.showLabels),a.labelThreshold&&a.labelThreshold(e.config.labelThreshold),a.labelType&&a.labelType(e.config.labelType),a.donut&&a.donut(!!e.config.donut),a.donutRatio&&a.donutRatio(e.config.donutRatio),e.configAxis(a),c.empty();var b=d3.select(c[0]).append("svg").datum(e.data);"number"==typeof e.config.transitionDuration&&(b=b.transition().duration(e.config.transitionDuration)),b.call(a),nv.utils.windowResize(a.update)}}};c.directive("ngD3",["$compile",function(){var a={scope:!0,compile:function(){return{post:function(a,c,e){var f=a.$parent,g=b(c),h=new d(a,g),i=[];a.$watch(e.ngD3,function(){var a=f.$eval(e.ngD3);a?j(a):k()});var j=function(c){c.$chartScope=a,c.$chartScope.refresh=function(){h.updateConfig(c),h.render()};var d=function(a){h.config.chartType!==a&&c.$chartScope.refresh()};if(i.push(f.$watch(e.ngD3+".chartType",d)),"string"==typeof c.data){var g=function(a){h.data=a?b.extend([],a):[],h.render()};i.push(f.$watch(c.data,g)),i.push(f.$watch(c.data+".length",function(){g(f.$eval(c.data))}))}},k=function(){angular.forEach(i,function(a){a()}),i=[],h.data=[],h.render()}}}}};return a}])}(window,jQuery);