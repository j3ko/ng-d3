/*! nv-chart v0.0.0 | 2014-05-10 */
!function(a,b){"use strict";var c=angular.module("nvChart",[]);Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e});var d=function(a,c,d){var e=this,f={chartType:null,data:[],color:[],margin:{},width:null,height:null,showLegend:!0,noData:null,tooltips:!0,tooltipContent:null,useInteractiveGuideline:!1,transitionDuration:null,showXAxis:!0,xValue:null,xShowMaxMin:!0,xAxisLabel:null,xAxisTickFormat:null,x2AxisLabel:null,x2AxisTickFormat:null,showYAxis:!0,yValue:null,yShowMaxMin:!0,yAxisLabel:null,yAxisTickFormat:null,rightAlignYAxis:!1,y1AxisLabel:null,y1AxisTickFormat:null,y2AxisLabel:null,y2AxisTickFormat:null,y3AxisLabel:null,y3AxisTickFormat:null,y4AxisLabel:null,y4AxisTickFormat:null,showLabels:!0,labelThreshold:.5,labelType:"key",donut:!1,donutRatio:0,staggerLabels:!1,showValues:!1,showDistX:!1,showDistY:!1,onlyCircles:!1},g=["xAxis","x2Axis","yAxis","y1Axis","y2Axis","y3Axis","y4Axis"];e.data=[],e.model=e.modelFn=null,e.config=b.extend(f,{}),e.updateConfig=function(a){e.config=b.extend(e.config,a),"object"==typeof e.config.data&&(e.data=e.config.data)},e.updateModel=function(){e.model&&e.drawModel(e.model)},e.setChartType=function(a){"string"==typeof a&&(e.modelFn=nv.models[a])},e.configAxis=function(a){"function"==typeof e.config.xValue&&a.x(e.config.xValue),"function"==typeof e.config.yValue&&a.y(e.config.yValue),a.xAxis&&a.xAxis.showMaxMin&&a.xAxis.showMaxMin(!!e.config.xShowMaxMin),a.yAxis&&a.yAxis.showMaxMin&&a.yAxis.showMaxMin(!!e.config.yShowMaxMin),angular.forEach(g,function(b){e.setAxisLabel(a,b),e.setTickFormat(a,b)})},e.setAxisLabel=function(a,b){var c=e.config[b+"Label"];a[b]&&a[b].axisLabel&&"string"==typeof c&&a[b].axisLabel(c)},e.setTickFormat=function(a,b){var c=e.config[b+"TickFormat"];a[b]&&a[b].tickFormat&&"string"==typeof c?a[b].tickFormat(d3.format(c)):a[b]&&a[b].tickFormat&&"function"==typeof c&&a[b].tickFormat(c)},e.render=function(){if(e.model&&d.unbindModel(e.model),e.setChartType(e.config.chartType),e.modelFn){var a=e.modelFn();e.drawModel(a)}},e.redraw=function(){e.model&&e.model.update()},e.drawModel=function(a){a.margin&&null!==e.config.margin&&"object"==typeof e.config.margin&&a.margin(e.config.margin),a.color&&b.isArray(e.config.color)&&e.config.color.length&&a.color(e.config.color),a.width&&"number"==typeof e.config.width&&a.width(e.config.width),a.height&&"number"==typeof e.config.height&&a.height(e.config.height),a.rightAlignYAxis&&a.rightAlignYAxis(!!e.config.rightAlignYAxis),a.showLegend&&a.showLegend(!!e.config.showLegend),a.showXAxis&&a.showXAxis(!!e.config.showXAxis),a.showYAxis&&a.showYAxis(!!e.config.showYAxis),"string"==typeof e.config.noData&&a.noData(e.config.noData),a.useInteractiveGuideline&&a.useInteractiveGuideline(!!e.config.useInteractiveGuideline),a.staggerLabels&&a.staggerLabels(!!e.config.staggerLabels),a.tooltips&&a.tooltips(!!e.config.tooltips),"string"==typeof e.config.tooltipContent&&a.tooltipContent(e.config.tooltipContent),a.showValues&&a.showValues(!!e.config.showValues),a.showLabels&&a.showLabels(!!e.config.showLabels),a.forceX&&e.config.forceX instanceof Array&&a.forceX(e.config.forceX),a.forceY&&e.config.forceY instanceof Array&&a.forceY(e.config.forceY),a.labelThreshold&&"number"==typeof e.config.labelThreshold&&a.labelThreshold(e.config.labelThreshold),a.labelType&&a.labelType(e.config.labelType),a.donut&&a.donut(!!e.config.donut),a.donutRatio&&a.donutRatio(e.config.donutRatio),a.showDistX&&a.showDistX(!!e.config.showDistX),a.showDistY&&a.showDistY(!!e.config.showDistY),a.scatter&&a.scatter.onlyCircles&&a.scatter.onlyCircles(!!e.config.onlyCircles),e.configAxis(a),c.children("svg").remove();var f=d3.select(c[0]).append("svg").datum(e.data);"number"==typeof e.config.transitionDuration&&(f=f.transition().duration(e.config.transitionDuration)),f.call(a),d.bindModel(a),e.model=a}},e=function(a,b){var c=this,d=["lines","bars","pie","discretebar","multibar","scatter"];c.bindModel=function(a){a.legend&&a.legend.dispatch.on("legendClick.nv-chart",function(a,c){b.$broadcast("legendClick.nv-chart",a,c)}),angular.forEach(d,function(b){c.bindElementClick(a,b)})},c.bindElementClick=function(a,c){a[c]&&a[c].dispatch.elementClick&&a[c].dispatch.on("elementClick.nv-chart",function(a,c){b.$broadcast("elementClick.nv-chart",a,c)})},c.unbindModel=function(a){a.legend&&a.legend.dispatch.on("legendClick.nv-chart",null),angular.forEach(d,function(b){c.unbindElementClick(a,b)})},c.unbindElementClick=function(a,b){a[b]&&a[b].dispatch.elementClick&&a[b].dispatch.on("elementClick.nv-chart",null)}};c.directive("nvChart",["$window","$rootScope",function(a,c){var f={scope:!0,link:function(f,g,h){var i=f.$parent,j=b(g),k=new e(f,c),l=new d(f,j,k),m=[];f.getElementDimensions=function(){return{h:j.height(),w:j.width()}},angular.element(a).bind("resize.nv-chart",l.redraw),f.$watch(h.nvChart,function(){var a=i.$eval(h.nvChart);a?n(a):o()});var n=function(c){c.$reload=function(){l.updateConfig(c),l.updateModel()},m.push(f.$watch(f.getElementDimensions,l.redraw,!0));var d=function(a){l.config.chartType!==a&&(l.updateConfig(c),l.render())};if(m.push(i.$watch(h.nvChart+".chartType",d)),"string"==typeof c.data){var e=function(a){l.data=a?b.extend([],a):[],l.render()};m.push(i.$watch(c.data,e)),m.push(i.$watch(c.data+".length",function(){e(i.$eval(c.data))}))}f.$on("$destroy",function(){o(),delete c.$reload,angular.element(a).off("resize.nv-chart",l.redraw),k.unbindModel(l.model)})},o=function(){angular.forEach(m,function(a){a()}),m=[],l.data=[],l.render()}}};return f}])}(window,jQuery);